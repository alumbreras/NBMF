x <- rpois(N, lambda = theta_star * lambdas)
hist(x)
N <- 1000
theta_star <- 7
lambdas <- rgamma(N, 1, 1)
x <- rpois(N, lambda = theta_star * lambdas)
hist(x)
N <- 1000
theta_star <- 7
lambdas <- rgamma(N, 1, 1)
x <- rpois(N, lambda = theta_star * lambdas)
hist(x)
N <- 1000
theta_star <- 7
lambdas <- rgamma(N, 1, 1)
x <- rpois(N, lambda = theta_star * lambdas)
hist(x)
N <- 1000
theta_star <- 7
lambdas <- rgamma(N, 1, 1)
x <- rpois(N, lambda = theta_star * lambdas)
hist(x)
N <- 1000
theta_star <- 7
lambdas <- rgamma(N, 1, 1)
x <- rpois(N, lambda = theta_star * lambdas)
hist(x)
N <- 1000
theta_star <- 7
lambdas <- rgamma(N, 1, 1)
x <- rpois(N, lambda = theta_star * lambdas)
hist(x)
x
mean(x)
var(x)
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
?rmultinom
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
C_samples <- array(NA, dim = c(nsamples, K, N))
C_samples
C <- array(NA, dim = c(K, N))
for(n in 1:N){
for(i in 1:nsamples){
# sample c_n
probs <- theta*lambdas[,n]
C[,n] <- rmultinom(1, x, probs/sum(probs))
# sample lambda_kn
for(k in 1:K){
alpha_k <- alpha + C_samples[k,n]
beta_k <- beta + theta
lambdas[k,n] <- rgamma(alpha_k, beta_k)
}
C_samples[i,,n] <- C
lambdas_samples[i,] <- lambdas
}
}
C_samples <- array(NA, dim = c(nsamples, K, N))
K
N
nsamples
array(NA, dim = c(nsamples, K, N))
C_samples[i,,n] <- C
C
rmultinom(1, x, probs/sum(probs))
C[,n]
C[,n] <- rmultinom(1, x, probs/sum(probs))
C[,n]
# sample lambda_kn
for(k in 1:K){
alpha_k <- alpha + C_samples[k,n]
beta_k <- beta + theta
lambdas[k,n] <- rgamma(alpha_k, beta_k)
}
C_samples[k,n]
k
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
rgamma(alpha_k, beta_k)
alpha_k
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
C
dim(C)
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
traceback()
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
lambdas[,n]
lambdas_samples[i,,n]
lambdas_samples[i,,n] <- lambdas[,n]
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
?colMeans
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
theta
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
lambdas_samples
dim(lambdas_samples)
colMeans(lambdas_samples, dims=1)
dim(colMeans(lambdas_samples, dims=1))
dim(lambdas_samples)
colMeans(C_samples, dims=1)
dim(colMeans(C_samples, dims=1))
N
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
samples <- gibbs(theta, E_lambda)
samples$E_lambda
samples$E_lambdas
samples$E_lambda
samples$E_lambd
samples$E_lam
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
lambdas[,n]
lambdas[,n]
probs <- theta*lambdas[,n]
probs <- theta*lambdas[,n]
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
lambdas
E_lambdas
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
dim(E_lambdas)
E_lambdas
samples$E_C
dim(samples$E_C)
dim(samples$E_lambdas)
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
lambdas
dim(lambdas)
lambdas[,n]
probs <- theta*lambdas[,n]
rmultinom(1, x, probs/sum(probs))
probs
rmultinom(1, x, probs)
probs
cat(n)
x[100]
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
n <- 1
x[1]
probs <- theta*lambdas[,n]
probs
rmultinom(1, x[n], probs/sum(probs))
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
?rgamma
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
K
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
xx <- seq(0,10, by=0.1)
xx
lb <- Q1(xx, E_C, E_lambdas)
Q1 <- function(theta, E_C, E_lambdas){
-theta*sum(E_lambdas) + log(theta) * sum(E_C)
}
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
xx <- seq(0,10, by=0.1)
lb <- Q1(xx, E_C, E_lambdas)
lb
plot(xx, lb)
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x)
x
lines(x, x)
?lines
plot(1:10)
lines(2:7)
lines(x)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x)
lines(x/10)
lines(lb)
lines(x)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x)
x
xx <- seq(0,100, by=0.1)
lb <- Q1(xx, E_C, E_lambdas)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x, lb)
xx <- seq(0,100, by=0.1)
lb <- Q1(xx, E_C, E_lambdas)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x, lb)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x, mean(lb))
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
xx <- seq(0,10, by=0.1)
lb <- Q1(xx, E_C, E_lambdas)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x, mean(lb))
mean(lb)
min(lb)
mean(lb)
mean(lb, na.rm=TRUE)
max(lb, na.rm=TRUE)
xx <- seq(0.1,10, by=0.1)
lb <- Q1(xx, E_C, E_lambdas)
plot(xx, lb, xlab="theta", ylab="Q-CH", main=i)
lines(x, mean(lb))
mean(lb)
lines(x, mean(lb))
x
mean(lb)
lines(x, rep(mean(lb), length(x)))
points(x, rep(mean(lb), length(x)))
x
x
sort(x)
hist(x)
hist(x, breaks=100)
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
Rcpp::sourceCpp('Documentos/Postdoc/src/rMMLE/src/likelihood_closeform.cpp')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
v
V
x
as.matrix(x)
dim(as.matrix(x))
dim(t(as.matrix(x)))
t(matrix(rep(1,1)))
t(matrix(rep(1,2)))
t(matrix(rep(1,10)))
V <- t(as.matrix(x))
W <- t(matrix(rep(1,1)))
V
W
likelihood_V_W_cpp(V, W, alpha, beta)
W
likelihood_V_W_cpp(V, 100, alpha, beta)
likelihood_V_W_cpp(V, W*0.1, alpha, beta)
likelihood_V_W_cpp(V, W*1000000, alpha, beta)
likelihood_V_W_cpp(V, W*1000°°000, alpha, beta)
likelihood_V_W_cpp(V, W*1000000, alpha, beta)
likelihood_V_W_cpp(V, W*100000000, alpha, beta)
likelihood_V_W_cpp(V, W*10000, alpha, beta)
likelihood_V_W_cpp(V, W*100, alpha, beta)
likelihood_V_W_cpp(V, W*10, alpha, beta)
likelihood_V_W_cpp(V, W*65, alpha, beta)
sapply(1:100, function(theta) {likelihood_V_W_cpp(V, as.matrix(theta), alpha, beta)})
thetas <- seq(0,100, by=0.1)
y <- sapply(1:100, function(theta) {likelihood_V_W_cpp(V, as.matrix(theta), alpha, beta)})
plot(thetas, y)
thetas <- seq(0,100, by=0.1)
y <- sapply(thetas, function(theta) {likelihood_V_W_cpp(V, as.matrix(theta), alpha, beta)})
plot(thetas, y)
EM_CH(x, K=5, theta=1, iter=35, alpha, beta)
rr <- recordPlot()
replayPlot(rr)
replayPlot(rr)
plot(thetas, y)
plot(xx, lb, xlab="theta", ylab="Q-C", main=i)
lines(thetas, y)
plot(xx, lb, xlab="theta", ylab="Q-C", main=i)
plot(xx, lb, xlab="theta", ylab="Q-C", main=i)
plot(xx, lb, xlab="theta", ylab="Q-C", main=i)
cat("\nem iter:", i)
cat("\nE_lambdas dim", dim(E_lambdas))
samples <- gibbs(x, theta, E_lambdas, alpha, beta)
E_C <- samples$E_C
E_lambdas <- samples$E_lambdas
theta = mean(x) / sum(E_lambdas)
cat("\ntheta:", theta)
xx <- seq(0.1,20, by=0.1)
lb <- Q2(xx, E_C)
plot(xx, lb, xlab="theta", ylab="Q-C", main=i)
i <- 1
cat("\nem iter:", i)
cat("\nE_lambdas dim", dim(E_lambdas))
samples <- gibbs(x, theta, E_lambdas, alpha, beta)
E_C <- samples$E_C
E_lambdas <- samples$E_lambdas
theta = mean(x) / sum(E_lambdas)
cat("\ntheta:", theta)
xx <- seq(0.1,20, by=0.1)
lb <- Q2(xx, E_C)
plot(xx, lb, xlab="theta", ylab="Q-C", main=i)
xx
lb <- Q2(xx, E_C)
samples <- gibbs(x, theta, E_lambdas, alpha, beta)
E_lambdas <- array(1, dim = c(K,N))
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
lines(thetas, y)
lines(thetas, y)
plot(xx, lb, xlab="theta", ylab="Q-C", main=i)
lines(thetas, y)
points(thetas, y, color="red")
points(thetas, y, col="red")
plot(xx, lb, xlab="theta", ylab="Q-C", main=i)
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
library(ggplot2)
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line()
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line()
p
print(p)
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw()
p
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw()
print(p)
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw() + ggtitle(i)
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw() + ggtitle(i)
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw() + ggtitle("jj")
print(p)
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw() + ggtitle(i)
print(p)
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw() +
xlab("theta") + ylab("Q-C") + ggtitle(i)
print(p)
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw() +
xlab("theta") + ylab("Q-CH") + ggtitle(i)
print(p)
df
df <- rbind(df, data.frame(theta=thetas, value = lb, method=i))
df
df <- rbind(df, data.frame(theta=thetas, value = lb, method=i))
data.frame(theta=thetas, value = lb, method=i)
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
df <- rbind(df, data.frame(theta=thetas, value = lb, method=as.character(i)))
df
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw() +
xlab("theta") + ylab("Q-CH") + ggtitle(i)
print(p)
debugSource('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
df <- rbind(df, data.frame(theta=thetas, value = lb, method=as.character(i)))
p <- ggplot(df, aes(x = theta, y=value, group=method, color=method)) + geom_line() + theme_bw() +
xlab("theta") + ylab("Q-CH") + ggtitle(i)
print(p)
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
source('~/Documentos/Postdoc/src/rMMLE/analysis/test_lower_bounds_q1_q2.R')
digamma(1)
digamma(0)
digamma(0.0001)
digamma(1/50)
digamma(1/70)
digamma(1/1000)
digamma(1/1000) - digamma(1)
digamma(1)
digamma(1)
digamma(1/1000) - digamma(1)
install.packages("logisticPCA")
View(z)
setwd("~/Documentos/Postdoc/src/rMMLE-DirBer/src")
devtools::load_all()
library(dplyr)
library(tidyr)
library(ggplot2)
library(Matrix)
library(gtools)
library(data.table)
text_components <-  7
text_features <- 7
V <-load_animals()
K <-100
modelVBaspect <- BernoulliNMF(V, K=K, model="aspectRcpp", method="VB",
alpha=1, beta=1, gamma=1/K,
iter=100)
Rcpp::sourceCpp('collapsed_gibbs_z_VB.cpp')
plot_trace_lowerbound(modelVBaspectaspect)
plot_trace_lowerbound(modelVBaspect)
p <- plot_dictionary(E_W, Kmax=100, rowlabels=TRUE)
E_Z <- modelVBaspect$E_Z
E_W <- modelVBaspect$E_W
E_H <- modelVBaspect$E_H
p <- plot_dictionary(E_W, Kmax=100, rowlabels=TRUE)
K <-10
modelVBaspect <- BernoulliNMF(V, K=K, model="aspectRcpp", method="VB",
alpha=1, beta=1, gamma=1,
iter=100)
E_Z <- modelVBaspect$E_Z
E_W <- modelVBaspect$E_W
E_H <- modelVBaspect$E_H
# Squared W with E[W]
p <- plot_dictionary(E_W, Kmax=100, rowlabels=TRUE)
p <- plot_dictionary(E_W, Kmax=100, rowlabels=TRUE)
load("../data/unvotes150.RData")
un_votes[un_votes$country == 'Federal Republic of Germany', ]$country_code <- 'FG'
un_votes[un_votes$country == 'Zanzibar', ]$country_code <- 'ZN'
un_votes[un_votes$country == 'Yemen Arab Republic', ]$country_code <- 'YR'
country_codes <- un_votes$country_code[match(rownames(V), un_votes$country)]
Kmax <- 8
likes <- rep(-Inf, Kmax)
lowerbounds <- rep(-Inf, Kmax)
models <- list()
for(k in 1:Kmax){
modelVBaspect <- BernoulliNMF(V, K=k, model="aspectRcpp", method="VB",
alpha=1, beta=1, gamma=1,
iter=200)
E_Z <- modelVBaspect$E_Z
E_W <- modelVBaspect$E_W
E_H <- modelVBaspect$E_H
like <- loglikelihood(modelVBaspect, V)$loglikelihood
lb   <- max(modelVBaspect$lowerbounds)
likes[k] <- like
lowerbounds[k] <- lb
models[[k]] <- modelVBaspect
df.results <- bind_rows(df.results, list(dataset = dataset,
model = "VB Aspect",
likelihood = like,
lowerbound = lb,
K=k))
}
